<!--pages/userInfo/userInfo.wxml-->
<view class="user-info-page">
  
  <!-- 顶部导航栏 -->
  <view class="user-info-header" style="padding-top: {{statusBarHeight}}px; height: {{totalNavHeight}}px;">
    <view class="user-info-header__blur"></view>
    <view class="user-info-header__content" style="height: {{navBarHeight}}px;">
      <view class="user-info-header__left" bindtap="onBackTap">
        <text class="user-info-header__back">返回</text>
      </view>
      <text class="user-info-header__title">个人信息</text>
      <view class="user-info-header__right"></view>
    </view>
  </view>

  <!-- 滚动内容 -->
  <scroll-view 
    class="user-info-scroll" 
    scroll-y 
    show-scrollbar="{{false}}"
  >
    <view class="user-info-content" style="padding-top: {{totalNavHeight + 32}}px;">
      
      <!-- 个人资料卡片组 -->
      <view class="info-card">
        <!-- 头像行 -->
        <button 
          class="info-row info-row--button" 
          open-type="chooseAvatar" 
          bindchooseavatar="onChooseAvatar"
        >
          <text class="info-row__label">头像</text>
          <view class="info-row__value">
            <image 
              class="info-avatar" 
              src="{{avatarUrl}}" 
              mode="aspectFill"
            />
            <text class="info-row__arrow">›</text>
          </view>
        </button>

        <!-- 分割线 -->
        <view class="info-divider"></view>

        <!-- 昵称行 -->
        <view class="info-row" bindtap="onNicknameTap">
          <text class="info-row__label">昵称</text>
          <view class="info-row__value">
            <text class="info-row__text">{{nickname}}</text>
            <text class="info-row__arrow">›</text>
          </view>
        </view>
      </view>

      <!-- 退出登录按钮 -->
      <view class="logout-section">
        <view class="logout-btn" bindtap="onLogoutTap">
          <text class="logout-btn__text">退出登录</text>
        </view>
      </view>

      <!-- 底部留白 -->
      <view class="bottom-spacer"></view>
    </view>
  </scroll-view>

  <!-- 昵称编辑弹窗 -->
  <view class="nickname-modal" wx:if="{{showNicknameModal}}" bindtap="onModalMaskTap">
    <view class="nickname-modal__content" catchtap="onModalContentTap">
      <view class="nickname-modal__header">
        <text class="nickname-modal__title">修改昵称</text>
      </view>
      <view class="nickname-modal__body">
        <input 
          class="nickname-modal__input"
          type="nickname"
          value="{{editingNickname}}"
          placeholder="请输入昵称"
          placeholder-style="color: #C7C7CC;"
          bindinput="onNicknameInput"
          bindblur="onNicknameBlur"
          focus="{{showNicknameModal}}"
          maxlength="30"
        />
      </view>
      <view class="nickname-modal__footer">
        <view class="nickname-modal__btn nickname-modal__btn--cancel" bindtap="onCancelNickname">
          取消
        </view>
        <view class="nickname-modal__btn nickname-modal__btn--confirm" bindtap="onConfirmNickname">
          确定
        </view>
      </view>
    </view>
  </view>

</view>
