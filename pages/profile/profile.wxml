<!--pages/profile/profile.wxml-->
<view class="profile-page">
  
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="profile-header" style="padding-top: {{statusBarHeight || 20}}px; height: {{totalNavHeight || 64}}px;">
    <view class="profile-header__blur"></view>
    <view class="profile-header__content" style="height: {{navBarHeight || 44}}px;">
      <text class="profile-header__title">æˆ‘çš„é…’åº“</text>
    </view>
  </view>

  <!-- æ»šåŠ¨å†…å®¹ -->
  <scroll-view 
    class="profile-scroll" 
    scroll-y 
    show-scrollbar="{{false}}"
    enable-back-to-top
    refresher-enabled
    bindrefresherrefresh="onPullDownRefresh"
  >
    <view class="profile-content">
      
      <!-- ç”¨æˆ·ä¿¡æ¯ -->
      <view class="user-info" bindtap="onAvatarTap">
        <view class="user-avatar">
          <!-- å·²ç™»å½•ï¼šæ˜¾ç¤ºç”¨æˆ·å¤´åƒ -->
          <image 
            wx:if="{{isLogin}}"
            class="user-avatar__image" 
            src="{{avatarUrl}}" 
            mode="aspectFill"
          />
          <!-- æœªç™»å½•ï¼šæ˜¾ç¤ºé»˜è®¤ç°è‰²äººåƒå›¾æ ‡ -->
          <view wx:else class="user-avatar__default">
            <text class="user-avatar__icon">ğŸ‘¤</text>
          </view>
        </view>
        <text class="user-name">{{userName}}</text>
      </view>

      <!-- ç»Ÿè®¡å¡ç‰‡ -->
       <view class="stats-card">
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--guozhi">{{icons.guozhi}}</text>
           <text class="stat-value">{{stats.totalNotes}}</text>
           <text class="stat-label">æ€»æ¯æ•°</text>
         </view>
        
        <view class="stat-divider"></view>
         
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--qianbao">{{icons.qianbao}}</text>
           <text class="stat-value">Â¥{{stats.totalSpent}}</text>
           <text class="stat-label">æ€»èŠ±è´¹</text>
         </view>
        
        <view class="stat-divider"></view>
         
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--riqi">{{icons.riqi}}</text>
           <text class="stat-value">{{stats.daysActive}}</text>
           <text class="stat-label">è®°å½•å¤©æ•°</text>
         </view>
      </view>

      <!-- ç…§ç‰‡å¢™ / ç©ºçŠ¶æ€ -->
      <view class="photo-grid {{isEmpty ? 'photo-grid--empty' : ''}}">
        <block wx:if="{{isEmpty}}">
          <view class="photo-grid__empty">
            <text class="photo-grid__empty-text">åˆ›å»ºç¬”è®°æ¥ä¸°å¯Œä½ çš„ç…§ç‰‡å¢™å§</text>
          </view>
        </block>
        
        <block wx:else>
          <block wx:for="{{logs}}" wx:key="id">
            <view 
              class="photo-item"
              data-id="{{item.id}}"
              bindtap="onPhotoTap"
            >
              <image 
                class="photo-item__image" 
                src="{{item.imagePath || item.imageUrl}}" 
                mode="aspectFill"
                lazy-load
                binderror="onImageError"
              />
            </view>
          </block>
        </block>
      </view>

      <!-- åº•éƒ¨ç•™ç™½ -->
      <view class="profile-bottom-spacer"></view>
    </view>
  </scroll-view>

</view>
