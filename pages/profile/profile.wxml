<!--pages/profile/profile.wxml-->
<view class="profile-page">
  
  <!-- 顶部导航栏 -->
  <view class="profile-header" style="padding-top: {{statusBarHeight || 20}}px; height: {{totalNavHeight || 64}}px;">
    <view class="profile-header__blur"></view>
    <view class="profile-header__content" style="height: {{navBarHeight || 44}}px;">
      <text class="profile-header__title">我的酒库</text>
    </view>
  </view>

  <!-- 滚动内容 -->
  <scroll-view 
    class="profile-scroll" 
    scroll-y 
    show-scrollbar="{{false}}"
    enable-back-to-top
    refresher-enabled
    refresher-triggered="{{refresherTriggered}}"
    bindrefresherrefresh="onPullDownRefresh"
  >
    <view class="profile-content">
      
      <!-- 用户信息 -->
      <view class="user-info" bindtap="onAvatarTap">
        <view class="user-avatar">
          <!-- 已登录：显示用户头像 -->
          <image 
            wx:if="{{isLogin}}"
            class="user-avatar__image" 
            src="{{avatarUrl}}" 
            mode="aspectFill"
          />
          <!-- 未登录：显示默认灰色人像图标 -->
          <view wx:else class="user-avatar__default">
            <text class="iconfont user-avatar__icon">{{icons.xiaoxiong}}</text>
          </view>
        </view>
        <text class="user-name">{{userName}}</text>
      </view>

      <!-- 统计卡片 -->
       <view class="stats-card">
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--guozhi">{{icons.guozhi}}</text>
           <text class="stat-value">{{stats.totalNotes}}</text>
           <text class="stat-label">总杯数</text>
         </view>
        
        <view class="stat-divider"></view>
         
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--qianbao">{{icons.qianbao}}</text>
           <text class="stat-value">¥{{stats.totalSpent}}</text>
           <text class="stat-label">总花费</text>
         </view>
        
        <view class="stat-divider"></view>
         
         <view class="stat-item">
           <text class="iconfont stat-icon stat-icon--riqi">{{icons.riqi}}</text>
           <text class="stat-value">{{stats.daysActive}}</text>
           <text class="stat-label">记录天数</text>
         </view>
      </view>

      <!-- 照片墙 / 空状态 -->
      <view class="photo-grid {{isEmpty ? 'photo-grid--empty' : ''}}">
        <block wx:if="{{isEmpty}}">
          <view class="photo-grid__empty">
            <text class="photo-grid__empty-text">创建笔记来丰富你的照片墙吧</text>
          </view>
        </block>
        
        <block wx:else>
          <block wx:for="{{logs}}" wx:key="id">
            <view 
              class="photo-item"
              data-id="{{item.id}}"
              bindtap="onPhotoTap"
            >
              <image 
                class="photo-item__image" 
                src="{{item.imagePath || item.imageUrl}}" 
                mode="aspectFill"
                lazy-load
                binderror="onImageError"
              />
            </view>
          </block>
        </block>
      </view>

      <!-- 底部留白 -->
      <view class="profile-bottom-spacer"></view>
    </view>
  </scroll-view>

</view>
