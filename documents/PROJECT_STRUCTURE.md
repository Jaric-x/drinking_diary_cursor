# é¡¹ç›®ç»“æ„æ€»è§ˆ

## ğŸ“ å®Œæ•´ç›®å½•ç»“æ„

```
drinking_diary_cursor/
â”‚
â”œâ”€â”€ pages/                          # é¡µé¢ç›®å½•
â”‚   â”œâ”€â”€ index/                      # é¦–é¡µï¼ˆåŒå‘Swiperæµè§ˆï¼‰
â”‚   â”‚   â”œâ”€â”€ index.js               # é¡µé¢é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ index.json             # é¡µé¢é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.wxml             # é¡µé¢ç»“æ„
â”‚   â”‚   â””â”€â”€ index.wxss             # é¡µé¢æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ editor/                     # ç¼–è¾‘é¡µï¼ˆåˆ›å»º/ç¼–è¾‘è®°å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ editor.js              # é¡µé¢é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ editor.json            # é¡µé¢é…ç½®
â”‚   â”‚   â”œâ”€â”€ editor.wxml            # é¡µé¢ç»“æ„
â”‚   â”‚   â””â”€â”€ editor.wxss            # é¡µé¢æ ·å¼
â”‚   â”‚
â”‚   â””â”€â”€ profile/                    # ä¸ªäººé¡µï¼ˆç»Ÿè®¡å’Œç…§ç‰‡å¢™ï¼‰
â”‚       â”œâ”€â”€ profile.js             # é¡µé¢é€»è¾‘
â”‚       â”œâ”€â”€ profile.json           # é¡µé¢é…ç½®
â”‚       â”œâ”€â”€ profile.wxml           # é¡µé¢ç»“æ„
â”‚       â””â”€â”€ profile.wxss           # é¡µé¢æ ·å¼
â”‚
â”œâ”€â”€ services/                       # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ storage.js                 # æ•°æ®å­˜å‚¨æœåŠ¡ï¼ˆCRUDï¼‰
â”‚   â”œâ”€â”€ file.js                    # æ–‡ä»¶ç®¡ç†æœåŠ¡ï¼ˆå›¾ç‰‡æŒä¹…åŒ–ï¼‰
â”‚   â””â”€â”€ util.js                    # å·¥å…·å‡½æ•°ï¼ˆæ—¥æœŸæ ¼å¼åŒ–ç­‰ï¼‰
â”‚
â”œâ”€â”€ constants/                      # å¸¸é‡é…ç½®
â”‚   â”œâ”€â”€ tags.js                    # é¢„è®¾æ ‡ç­¾ï¼ˆ9ä¸ªå›ºå®šæ ‡ç­¾ï¼‰
â”‚   â””â”€â”€ mock-data.js               # æµ‹è¯•æ•°æ®ï¼ˆ5æ¡ç¤ºä¾‹è®°å½•ï¼‰
â”‚
â”œâ”€â”€ styles/                         # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ variables.wxss             # CSSå˜é‡å®šä¹‰
â”‚   â””â”€â”€ common.wxss                # åŸå­åŒ–æ ·å¼ç±»
â”‚
â”œâ”€â”€ components/                     # è‡ªå®šä¹‰ç»„ä»¶ï¼ˆé¢„ç•™ï¼‰
â”‚   â””â”€â”€ navigation-bar/            # è‡ªå®šä¹‰å¯¼èˆªæ ç»„ä»¶
â”‚       â”œâ”€â”€ navigation-bar.js
â”‚       â”œâ”€â”€ navigation-bar.json
â”‚       â”œâ”€â”€ navigation-bar.wxml
â”‚       â””â”€â”€ navigation-bar.wxss
â”‚
â”œâ”€â”€ custom-tab-bar/                 # è‡ªå®šä¹‰TabBar
â”‚   â”œâ”€â”€ index.js                   # TabBaré€»è¾‘
â”‚   â”œâ”€â”€ index.json                 # TabBaré…ç½®
â”‚   â”œâ”€â”€ index.wxml                 # TabBarç»“æ„
â”‚   â””â”€â”€ index.wxss                 # TabBaræ ·å¼
â”‚
â”œâ”€â”€ app.js                          # å°ç¨‹åºå…¥å£é€»è¾‘
â”œâ”€â”€ app.json                        # å°ç¨‹åºå…¨å±€é…ç½®
â”œâ”€â”€ app.wxss                        # å°ç¨‹åºå…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ project.config.json             # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ project.private.config.json    # ç§æœ‰é…ç½®æ–‡ä»¶
â”œâ”€â”€ sitemap.json                    # ç«™ç‚¹åœ°å›¾é…ç½®
â”‚
â”œâ”€â”€ prd.md                          # äº§å“éœ€æ±‚æ–‡æ¡£
â”œâ”€â”€ TECHNICAL_DESIGN.md             # æŠ€æœ¯æ¶æ„æ–‡æ¡£
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ DEVELOPMENT.md                  # å¼€å‘æ–‡æ¡£
â””â”€â”€ PROJECT_STRUCTURE.md            # æœ¬æ–‡ä»¶
```

## ğŸ“„ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒé¡µé¢

#### 1. é¦–é¡µ (pages/index/)
**åŠŸèƒ½**ï¼šåŒå‘Swiperå¡ç‰‡æµï¼Œçºµå‘åˆ‡æ¢æ—¥æœŸï¼Œæ¨ªå‘åˆ‡æ¢åŒæ—¥è®°å½•

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- åŠ¨æ€èƒŒæ™¯å±‚ï¼ˆå½“å‰å¡ç‰‡å›¾ç‰‡é«˜æ–¯æ¨¡ç³Šï¼‰
- åµŒå¥—Swiperå®ç°äºŒç»´å¯¼èˆª
- å³ä¾§æ—¥æœŸæŒ‡ç¤ºå™¨
- é—®å€™è¯­æ ï¼ˆæ ¹æ®æ—¶æ®µå˜åŒ–ï¼‰
- ç©ºçŠ¶æ€å¼•å¯¼

**å…³é”®ä»£ç **ï¼š
```javascript
// æ•°æ®åˆ†ç»„é€»è¾‘
const groupMap = {};
logs.forEach(log => {
  if (!groupMap[log.dateString]) {
    groupMap[log.dateString] = [];
  }
  groupMap[log.dateString].push(log);
});
```

#### 2. ç¼–è¾‘é¡µ (pages/editor/)
**åŠŸèƒ½**ï¼šåˆ›å»ºå’Œç¼–è¾‘é…’å“è®°å½•

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- å›¾ç‰‡ä¸Šä¼ å’Œå‹ç¼©
- è¡¨å•éªŒè¯ï¼ˆå›¾ç‰‡ã€åç§°ã€è¯„åˆ†å¿…å¡«ï¼‰
- é¢„è®¾æ ‡ç­¾ + è‡ªå®šä¹‰æ ‡ç­¾
- 5æ˜Ÿè¯„åˆ†ç³»ç»Ÿ
- åˆ é™¤ç¡®è®¤æœºåˆ¶

**å…³é”®ä»£ç **ï¼š
```javascript
// å›¾ç‰‡æŒä¹…åŒ–
const compressed = await fileService.compressImage(tempPath, 80);
const savedPath = await fileService.saveImage(compressed);
```

#### 3. ä¸ªäººé¡µ (pages/profile/)
**åŠŸèƒ½**ï¼šç»Ÿè®¡æ•°æ®å’Œç…§ç‰‡å¢™å±•ç¤º

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ä¸‰åˆ—ç»Ÿè®¡å¡ç‰‡ï¼ˆæ€»æ¯æ•°/æ€»èŠ±è´¹/è®°å½•å¤©æ•°ï¼‰
- 3åˆ—ç½‘æ ¼ç…§ç‰‡å¢™
- ä¸‹æ‹‰åˆ·æ–°
- ç©ºçŠ¶æ€æç¤º

**å…³é”®ä»£ç **ï¼š
```javascript
// ç»Ÿè®¡è®¡ç®—
const totalSpent = logs.reduce((sum, log) => sum + (log.price || 0), 0);
const daysActive = util.calculateMonthDays(logs);
```

### æœåŠ¡å±‚

#### 1. storage.js - æ•°æ®å­˜å‚¨æœåŠ¡
**èŒè´£**ï¼šç®¡ç†æ‰€æœ‰æœ¬åœ°æ•°æ®çš„CRUDæ“ä½œ

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `getLogs()` - è·å–æ‰€æœ‰è®°å½•ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
- `saveLog(log)` - ä¿å­˜/æ›´æ–°è®°å½•
- `deleteLog(id)` - åˆ é™¤è®°å½•
- `getUserTags()` - è·å–è‡ªå®šä¹‰æ ‡ç­¾
- `addUserTag(tag)` - æ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾

**å­˜å‚¨é”®**ï¼š
- `drinking_diary_logs` - ä¸»è®°å½•åˆ—è¡¨
- `drinking_diary_tags` - è‡ªå®šä¹‰æ ‡ç­¾

#### 2. file.js - æ–‡ä»¶ç®¡ç†æœåŠ¡
**èŒè´£**ï¼šå¤„ç†å›¾ç‰‡çš„æŒä¹…åŒ–å’Œåˆ é™¤

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `saveImage(tempPath)` - å°†ä¸´æ—¶å›¾ç‰‡ä¿å­˜åˆ°æ°¸ä¹…ç›®å½•
- `deleteImage(path)` - åˆ é™¤æœ¬åœ°å›¾ç‰‡æ–‡ä»¶
- `compressImage(src, quality)` - å‹ç¼©å›¾ç‰‡

**å…³é”®é€»è¾‘**ï¼š
```javascript
// ä½¿ç”¨FileSystemManagerå°†ä¸´æ—¶æ–‡ä»¶å¤åˆ¶åˆ°USER_DATA_PATH
fs.copyFile({
  srcPath: tempFilePath,
  destPath: `${wx.env.USER_DATA_PATH}/${fileName}`
});
```

#### 3. util.js - å·¥å…·å‡½æ•°
**èŒè´£**ï¼šæä¾›é€šç”¨çš„å·¥å…·æ–¹æ³•

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `formatDate(date)` - æ ¼å¼åŒ–ä¸º "MM.DD"
- `formatTime(date)` - æ ¼å¼åŒ–ä¸º "HH:mm"
- `generateId()` - ç”Ÿæˆå”¯ä¸€ID
- `getGreeting()` - è·å–æ—¶æ®µé—®å€™è¯­
- `calculateMonthDays(logs)` - è®¡ç®—æœ¬æœˆè®°å½•å¤©æ•°

### æ ·å¼ç³»ç»Ÿ

#### 1. variables.wxss - CSSå˜é‡
å®šä¹‰äº†å…¨å±€çš„é¢œè‰²ã€åœ†è§’ã€é˜´å½±ç­‰è®¾è®¡è§„èŒƒï¼š

```css
--color-primary: #007AFF;      /* å“ç‰Œè“ */
--color-bg: #F2F2F7;           /* èƒŒæ™¯ç° */
--color-star: #FF9500;         /* è¯„åˆ†æ©™ */
--radius-card: 32rpx;          /* å¡ç‰‡åœ†è§’ */
--shadow-card: 0 16rpx 40rpx rgba(0, 0, 0, 0.08);
```

#### 2. common.wxss - åŸå­åŒ–æ ·å¼
æä¾›äº†å¸¸ç”¨çš„åŸå­åŒ–æ ·å¼ç±»ï¼š

```css
.flex-center { display: flex; justify-content: center; align-items: center; }
.text-primary { color: var(--color-primary); }
.shadow-card { box-shadow: var(--shadow-card); }
.rounded-card { border-radius: var(--radius-card); }
```

### è‡ªå®šä¹‰TabBar

**ç»“æ„**ï¼š
- å·¦ä¾§ï¼šHomeå›¾æ ‡
- ä¸­é—´ï¼šæ‚¬æµ®å¤§æŒ‰é’®ï¼ˆ+å·ï¼‰
- å³ä¾§ï¼šProfileå›¾æ ‡

**ç‰¹æ€§**ï¼š
- é«˜é€ç£¨ç ‚ç»ç’ƒèƒŒæ™¯
- ä¸­é—´æŒ‰é’®çªèµ·æ‚¬æµ®æ•ˆæœ
- ç‚¹å‡»åé¦ˆåŠ¨ç”»
- çŠ¶æ€åŒæ­¥æœºåˆ¶

## ğŸ”„ æ•°æ®æµ

### åˆ›å»ºè®°å½•æµç¨‹
```
ç”¨æˆ·ç‚¹å‡»+ â†’ ç¼–è¾‘é¡µ â†’ é€‰æ‹©å›¾ç‰‡ â†’ å‹ç¼©ä¿å­˜ â†’ å¡«å†™ä¿¡æ¯ â†’ 
éªŒè¯è¡¨å• â†’ ä¿å­˜åˆ°Storage â†’ è¿”å›é¦–é¡µ â†’ åˆ·æ–°æ•°æ®
```

### ç¼–è¾‘è®°å½•æµç¨‹
```
ç‚¹å‡»å¡ç‰‡ â†’ ç¼–è¾‘é¡µ â†’ åŠ è½½è®°å½•æ•°æ® â†’ ä¿®æ”¹ä¿¡æ¯ â†’ 
ä¿å­˜æ›´æ–° â†’ è¿”å›é¦–é¡µ â†’ åˆ·æ–°æ•°æ®
```

### åˆ é™¤è®°å½•æµç¨‹
```
ç¼–è¾‘é¡µç‚¹å‡»åˆ é™¤ â†’ ç¡®è®¤å¼¹çª— â†’ åˆ é™¤Storageæ•°æ® â†’ 
åˆ é™¤å…³è”å›¾ç‰‡ â†’ è¿”å›é¦–é¡µ â†’ åˆ·æ–°æ•°æ®
```

## ğŸ¨ è®¾è®¡è§„èŒƒ

### è‰²å½©ä½“ç³»
| ç”¨é€” | é¢œè‰²å€¼ | å˜é‡å |
|------|--------|--------|
| å“ç‰Œè‰² | #007AFF | --color-primary |
| èƒŒæ™¯è‰² | #F2F2F7 | --color-bg |
| å¡ç‰‡èƒŒæ™¯ | #FFFFFF | --color-card-bg |
| è¯„åˆ†æ˜Ÿæ˜Ÿ | #FF9500 | --color-star |
| å±é™©æ“ä½œ | #FF3B30 | --color-danger |

### åœ†è§’è§„èŒƒ
| å…ƒç´  | åœ†è§’å€¼ | å˜é‡å |
|------|--------|--------|
| å¡ç‰‡ | 32rpx | --radius-card |
| æŒ‰é’® | 24rpx | --radius-btn |
| æ ‡ç­¾ | 999rpx | --radius-tag |

### é˜´å½±è§„èŒƒ
| å…ƒç´  | é˜´å½±å€¼ | å˜é‡å |
|------|--------|--------|
| å¡ç‰‡ | 0 16rpx 40rpx rgba(0,0,0,0.08) | --shadow-card |
| æ‚¬æµ® | 0 8rpx 24rpx rgba(0,0,0,0.15) | --shadow-float |

## ğŸ“Š æ•°æ®æ¨¡å‹

### Logï¼ˆè®°å½•ï¼‰
```typescript
interface Log {
  id: string;              // å”¯ä¸€æ ‡è¯†
  name: string;            // é…’å“åç§°ï¼ˆå¿…å¡«ï¼‰
  rating: number;          // è¯„åˆ† 1-5ï¼ˆå¿…å¡«ï¼‰
  imagePath: string;       // æœ¬åœ°æ°¸ä¹…è·¯å¾„ï¼ˆå¿…å¡«ï¼‰
  imageUrl: string;        // å›¾ç‰‡URLï¼ˆå…¼å®¹ï¼‰
  location?: string;       // åœ°ç‚¹ï¼ˆå¯é€‰ï¼‰
  price?: number;          // ä»·æ ¼ï¼ˆå¯é€‰ï¼‰
  notes?: string;          // å“é‰´ç¬”è®°ï¼ˆå¯é€‰ï¼‰
  tags: string[];          // æ ‡ç­¾æ•°ç»„
  createTime: number;      // åˆ›å»ºæ—¶é—´æˆ³
  updateTime: number;      // æ›´æ–°æ—¶é—´æˆ³
  dateString: string;      // æ ¼å¼åŒ–æ—¥æœŸ "MM.DD"
  timeString: string;      // æ ¼å¼åŒ–æ—¶é—´ "HH:mm"
}
```

### Statsï¼ˆç»Ÿè®¡ï¼‰
```typescript
interface Stats {
  totalNotes: number;      // æ€»æ¯æ•°
  totalSpent: number;      // æ€»èŠ±è´¹
  daysActive: number;      // æœ¬æœˆè®°å½•å¤©æ•°
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

1. **å›¾ç‰‡æ‡’åŠ è½½**ï¼šæ‰€æœ‰å›¾ç‰‡ä½¿ç”¨ `lazy-load="{{true}}"`
2. **å›¾ç‰‡å‹ç¼©**ï¼šä¸Šä¼ æ—¶è‡ªåŠ¨å‹ç¼©åˆ°80%è´¨é‡
3. **æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šé™åˆ¶å›¾ç‰‡ < 2MB
4. **åˆ—è¡¨ä¼˜åŒ–**ï¼šç…§ç‰‡å¢™ä½¿ç”¨Gridå¸ƒå±€ï¼Œé¿å…å¤æ‚è®¡ç®—
5. **Swiperä¼˜åŒ–**ï¼šè®¾ç½®åˆç†çš„ `duration` å’Œ `previous-margin`

## ğŸ” å®‰å…¨ä¸éšç§

1. **æœ¬åœ°å­˜å‚¨**ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸ä¸Šä¼ æœåŠ¡å™¨
2. **å›¾ç‰‡æŒä¹…åŒ–**ï¼šå›¾ç‰‡å­˜å‚¨åœ¨ `wx.env.USER_DATA_PATH`
3. **æ•°æ®éš”ç¦»**ï¼šæ¯ä¸ªç”¨æˆ·çš„æ•°æ®å®Œå…¨ç‹¬ç«‹
4. **æ— ç½‘ç»œè¯·æ±‚**ï¼šåº”ç”¨å®Œå…¨ç¦»çº¿è¿è¡Œ

## ğŸ“ å¼€å‘è§„èŒƒ

1. **ä»£ç é£æ ¼**ï¼šéµå¾ªESLintè§„èŒƒ
2. **å‘½åè§„èŒƒ**ï¼šé©¼å³°å‘½åï¼ˆå‡½æ•°ï¼‰ã€å¤§å†™ä¸‹åˆ’çº¿ï¼ˆå¸¸é‡ï¼‰
3. **æ³¨é‡Šè§„èŒƒ**ï¼šæ‰€æœ‰å‡½æ•°å¿…é¡»æœ‰JSDocæ³¨é‡Š
4. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰å¼‚æ­¥æ“ä½œå¿…é¡»try-catch
5. **ç”¨æˆ·åé¦ˆ**ï¼šæ‰€æœ‰æ“ä½œå¿…é¡»æœ‰Toastæˆ–Modalæç¤º

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯ç‚¹

1. **åµŒå¥—Swiper**ï¼šå®ç°äºŒç»´å¯¼èˆª
2. **å›¾ç‰‡æŒä¹…åŒ–**ï¼šFileSystemManager API
3. **è‡ªå®šä¹‰TabBar**ï¼šé«˜é€æ¯›ç»ç’ƒæ•ˆæœ
4. **åŠ¨æ€èƒŒæ™¯**ï¼šé«˜æ–¯æ¨¡ç³Š + å¹³æ»‘è¿‡æ¸¡
5. **åŸå­åŒ–CSS**ï¼šæé«˜æ ·å¼å¤ç”¨æ€§
6. **Skylineæ¸²æŸ“**ï¼šæå‡æ€§èƒ½å’Œä½“éªŒ

